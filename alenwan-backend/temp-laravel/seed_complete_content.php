<?php

require __DIR__.'/vendor/autoload.php';

$app = require_once __DIR__.'/bootstrap/app.php';
$app->make('Illuminate\Contracts\Console\Kernel')->bootstrap();

use App\Models\Movie;
use App\Models\Series;
use App\Models\Season;
use App\Models\Episode;
use App\Models\Podcast;
use App\Models\Sport;
use App\Models\Documentary;
use App\Models\Cartoon;
use App\Models\LiveStream;
use App\Models\Category;
use App\Models\Language;
use Illuminate\Support\Facades\DB;

echo "üöÄ Starting content seeding...\n\n";

// Get categories and languages
$categories = Category::all();
$languages = Language::all();

if ($categories->isEmpty() || $languages->isEmpty()) {
    echo "‚ùå Please seed categories and languages first!\n";
    exit(1);
}

$actionCategory = $categories->where('name->en', 'Action')->first() ?? $categories->first();
$dramaCategory = $categories->where('name->en', 'Drama')->first() ?? $categories->skip(1)->first();
$comedyCategory = $categories->where('name->en', 'Comedy')->first() ?? $categories->skip(2)->first();
$sportsCategory = $categories->where('name->en', 'Sports')->first() ?? $categories->skip(3)->first();

$arabicLang = $languages->where('code', 'ar')->first() ?? $languages->first();
$englishLang = $languages->where('code', 'en')->first() ?? $languages->skip(1)->first();

echo "üìÅ Categories found: " . $categories->count() . "\n";
echo "üåç Languages found: " . $languages->count() . "\n\n";

// ========== MOVIES ==========
echo "üé¨ Creating Movies...\n";
$movies = [
    [
        'title' => 'The Last Kingdom',
        'title_ar' => 'ÿßŸÑŸÖŸÖŸÑŸÉÿ© ÿßŸÑÿ£ÿÆŸäÿ±ÿ©',
        'description' => 'An epic action movie about a warrior defending his kingdom',
        'description_ar' => 'ŸÅŸäŸÑŸÖ ÿ£ŸÉÿ¥ŸÜ ŸÖŸÑÿ≠ŸÖŸä ÿπŸÜ ŸÖÿ≠ÿßÿ±ÿ® ŸäÿØÿßŸÅÿπ ÿπŸÜ ŸÖŸÖŸÑŸÉÿ™Ÿá',
        'duration' => 145,
        'release_year' => 2024,
        'rating' => 8.5,
        'quality' => '4K',
        'category_id' => $actionCategory->id,
    ],
    [
        'title' => 'Desert Storm',
        'title_ar' => 'ÿπÿßÿµŸÅÿ© ÿßŸÑÿµÿ≠ÿ±ÿßÿ°',
        'description' => 'A thrilling adventure in the Arabian desert',
        'description_ar' => 'ŸÖÿ∫ÿßŸÖÿ±ÿ© ŸÖÿ´Ÿäÿ±ÿ© ŸÅŸä ÿßŸÑÿµÿ≠ÿ±ÿßÿ° ÿßŸÑÿπÿ±ÿ®Ÿäÿ©',
        'duration' => 132,
        'release_year' => 2024,
        'rating' => 7.8,
        'quality' => 'HD',
        'category_id' => $actionCategory->id,
    ],
    [
        'title' => 'Family Bonds',
        'title_ar' => 'ÿ±Ÿàÿßÿ®ÿ∑ ÿπÿßÿ¶ŸÑŸäÿ©',
        'description' => 'A touching drama about family relationships',
        'description_ar' => 'ÿØÿ±ÿßŸÖÿß ŸÖÿ§ÿ´ÿ±ÿ© ÿπŸÜ ÿßŸÑÿπŸÑÿßŸÇÿßÿ™ ÿßŸÑÿ£ÿ≥ÿ±Ÿäÿ©',
        'duration' => 118,
        'release_year' => 2024,
        'rating' => 8.2,
        'quality' => 'HD',
        'category_id' => $dramaCategory->id,
    ],
    [
        'title' => 'Laugh Out Loud',
        'title_ar' => 'ÿßÿ∂ÿ≠ŸÉ ÿ®ÿµŸàÿ™ ÿπÿßŸÑŸä',
        'description' => 'A hilarious comedy that will make you laugh',
        'description_ar' => 'ŸÉŸàŸÖŸäÿØŸäÿß ŸÖÿ∂ÿ≠ŸÉÿ© ÿ≥ÿ™ÿ¨ÿπŸÑŸÉ ÿ™ÿ∂ÿ≠ŸÉ',
        'duration' => 95,
        'release_year' => 2024,
        'rating' => 7.5,
        'quality' => 'HD',
        'category_id' => $comedyCategory->id,
    ],
    [
        'title' => 'Champions Rise',
        'title_ar' => 'ÿµÿπŸàÿØ ÿßŸÑÿ£ÿ®ÿ∑ÿßŸÑ',
        'description' => 'An inspiring sports movie about determination',
        'description_ar' => 'ŸÅŸäŸÑŸÖ ÿ±Ÿäÿßÿ∂Ÿä ŸÖŸÑŸáŸÖ ÿπŸÜ ÿßŸÑÿ•ÿµÿ±ÿßÿ±',
        'duration' => 128,
        'release_year' => 2023,
        'rating' => 8.0,
        'quality' => '4K',
        'category_id' => $sportsCategory->id,
    ],
];

foreach ($movies as $movieData) {
    $slug = \Illuminate\Support\Str::slug($movieData['title']) . '-' . rand(1000, 9999);

    $movie = Movie::create([
        'title' => ['en' => $movieData['title'], 'ar' => $movieData['title_ar']],
        'slug' => $slug,
        'description' => ['en' => $movieData['description'], 'ar' => $movieData['description_ar']],
        'duration' => $movieData['duration'],
        'release_year' => $movieData['release_year'],
        'rating' => $movieData['rating'],
        'is_featured' => rand(0, 1),
        'is_trending' => rand(0, 1),
        'views_count' => rand(1000, 50000),
        'video_url' => 'https://sample-videos.com/video123/mp4/720/big_buck_bunny_720p_1mb.mp4',
        'trailer_url' => 'https://sample-videos.com/video123/mp4/480/big_buck_bunny_480p_1mb.mp4',
        'thumbnail' => 'https://via.placeholder.com/300x450/667eea/ffffff?text=' . urlencode($movieData['title']),
        'poster' => 'https://via.placeholder.com/1920x1080/667eea/ffffff?text=' . urlencode($movieData['title']),
        'quality' => $movieData['quality'],
        'category_id' => $movieData['category_id'],
        'language_id' => rand(0, 1) ? $arabicLang->id : $englishLang->id,
        'is_published' => true,
    ]);

    echo "  ‚úì Created movie: {$movieData['title']}\n";
}

// ========== SERIES ==========
echo "\nüì∫ Creating Series...\n";
$seriesData = [
    [
        'title' => 'Desert Warriors',
        'title_ar' => 'ŸÖÿ≠ÿßÿ±ÿ®Ÿà ÿßŸÑÿµÿ≠ÿ±ÿßÿ°',
        'description' => 'An epic series about tribal conflicts in the desert',
        'description_ar' => 'ŸÖÿ≥ŸÑÿ≥ŸÑ ŸÖŸÑÿ≠ŸÖŸä ÿπŸÜ ÿµÿ±ÿßÿπÿßÿ™ ÿßŸÑŸÇÿ®ÿßÿ¶ŸÑ ŸÅŸä ÿßŸÑÿµÿ≠ÿ±ÿßÿ°',
        'seasons_count' => 2,
        'category_id' => $actionCategory->id,
    ],
    [
        'title' => 'Modern Family',
        'title_ar' => 'ÿπÿßÿ¶ŸÑÿ© ÿπÿµÿ±Ÿäÿ©',
        'description' => 'A comedy series about a contemporary Arab family',
        'description_ar' => 'ŸÖÿ≥ŸÑÿ≥ŸÑ ŸÉŸàŸÖŸäÿØŸä ÿπŸÜ ÿπÿßÿ¶ŸÑÿ© ÿπÿ±ÿ®Ÿäÿ© ŸÖÿπÿßÿµÿ±ÿ©',
        'seasons_count' => 3,
        'category_id' => $comedyCategory->id,
    ],
];

foreach ($seriesData as $seriesInfo) {
    $slug = \Illuminate\Support\Str::slug($seriesInfo['title']) . '-' . rand(1000, 9999);

    $series = Series::create([
        'title' => ['en' => $seriesInfo['title'], 'ar' => $seriesInfo['title_ar']],
        'slug' => $slug,
        'description' => ['en' => $seriesInfo['description'], 'ar' => $seriesInfo['description_ar']],
        'release_year' => 2024,
        'rating' => rand(75, 95) / 10,
        'is_featured' => rand(0, 1),
        'is_trending' => rand(0, 1),
        'views_count' => rand(5000, 100000),
        'thumbnail' => 'https://via.placeholder.com/300x450/764ba2/ffffff?text=' . urlencode($seriesInfo['title']),
        'poster' => 'https://via.placeholder.com/1920x1080/764ba2/ffffff?text=' . urlencode($seriesInfo['title']),
        'trailer_url' => 'https://sample-videos.com/video123/mp4/480/big_buck_bunny_480p_1mb.mp4',
        'category_id' => $seriesInfo['category_id'],
        'language_id' => $arabicLang->id,
        'is_published' => true,
    ]);

    echo "  ‚úì Created series: {$seriesInfo['title']}\n";

    // Create seasons and episodes
    for ($s = 1; $s <= $seriesInfo['seasons_count']; $s++) {
        $season = Season::create([
            'series_id' => $series->id,
            'season_number' => $s,
            'title' => ['en' => "Season $s", 'ar' => "ÿßŸÑŸÖŸàÿ≥ŸÖ $s"],
            'description' => ['en' => "Season $s of {$seriesInfo['title']}", 'ar' => "ÿßŸÑŸÖŸàÿ≥ŸÖ $s ŸÖŸÜ {$seriesInfo['title_ar']}"],
            'release_year' => 2024,
            'is_published' => true,
        ]);

        // Create 5 episodes per season
        for ($e = 1; $e <= 5; $e++) {
            $epSlug = $slug . '-s' . $s . '-e' . $e;
            Episode::create([
                'series_id' => $series->id,
                'season_id' => $season->id,
                'episode_number' => $e,
                'slug' => $epSlug,
                'title' => ['en' => "Episode $e", 'ar' => "ÿßŸÑÿ≠ŸÑŸÇÿ© $e"],
                'description' => ['en' => "Episode $e of Season $s", 'ar' => "ÿßŸÑÿ≠ŸÑŸÇÿ© $e ŸÖŸÜ ÿßŸÑŸÖŸàÿ≥ŸÖ $s"],
                'duration' => rand(40, 60),
                'video_url' => 'https://sample-videos.com/video123/mp4/720/big_buck_bunny_720p_1mb.mp4',
                'thumbnail' => 'https://via.placeholder.com/300x169/764ba2/ffffff?text=S' . $s . 'E' . $e,
                'is_published' => true,
                'views_count' => rand(1000, 10000),
            ]);
        }
        echo "    ‚úì Created Season $s with 5 episodes\n";
    }
}

// ========== PODCASTS ==========
echo "\nüéôÔ∏è Creating Podcasts...\n";
for ($i = 1; $i <= 5; $i++) {
    $podSlug = 'podcast-episode-' . $i . '-' . rand(1000, 9999);
    Podcast::create([
        'title' => ['en' => "Podcast Episode $i", 'ar' => "ÿ≠ŸÑŸÇÿ© ÿ®ŸàÿØŸÉÿßÿ≥ÿ™ $i"],
        'slug' => $podSlug,
        'description' => ['en' => "Interesting podcast episode about various topics", 'ar' => "ÿ≠ŸÑŸÇÿ© ÿ®ŸàÿØŸÉÿßÿ≥ÿ™ ŸÖÿ´Ÿäÿ±ÿ© ÿπŸÜ ŸÖŸàÿßÿ∂Ÿäÿπ ŸÖÿ™ŸÜŸàÿπÿ©"],
        'host' => ['en' => "Host Name $i", 'ar' => "ÿßŸÑŸÖŸÇÿØŸÖ $i"],
        'duration' => rand(30, 90),
        'audio_url' => 'https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3',
        'thumbnail' => 'https://via.placeholder.com/300x300/667eea/ffffff?text=Podcast+' . $i,
        'release_date' => now()->subDays(rand(1, 30)),
        'is_featured' => rand(0, 1),
        'is_published' => true,
        'views_count' => rand(500, 5000),
        'category_id' => $categories->random()->id,
        'language_id' => $arabicLang->id,
    ]);
    echo "  ‚úì Created podcast $i\n";
}

// ========== SPORTS ==========
echo "\n‚öΩ Creating Sports Content...\n";
for ($i = 1; $i <= 5; $i++) {
    $sportSlug = 'match-highlights-' . $i . '-' . rand(1000, 9999);
    Sport::create([
        'title' => ['en' => "Match Highlights $i", 'ar' => "ŸÖŸÑÿÆÿµ ÿßŸÑŸÖÿ®ÿßÿ±ÿßÿ© $i"],
        'slug' => $sportSlug,
        'description' => ['en' => "Exciting match highlights", 'ar' => "ŸÖŸÑÿÆÿµÿßÿ™ ŸÖÿ®ÿßÿ±Ÿäÿßÿ™ ŸÖÿ´Ÿäÿ±ÿ©"],
        'sport_type' => ['football', 'basketball', 'tennis'][rand(0, 2)],
        'duration' => rand(10, 30),
        'video_url' => 'https://sample-videos.com/video123/mp4/720/big_buck_bunny_720p_1mb.mp4',
        'thumbnail' => 'https://via.placeholder.com/300x169/A20136/ffffff?text=Sports+' . $i,
        'match_date' => now()->subDays(rand(1, 7)),
        'is_live' => false,
        'is_featured' => rand(0, 1),
        'is_published' => true,
        'views_count' => rand(1000, 20000),
        'category_id' => $sportsCategory->id,
        'language_id' => $arabicLang->id,
    ]);
    echo "  ‚úì Created sports content $i\n";
}

// ========== DOCUMENTARIES ==========
echo "\nüìñ Creating Documentaries...\n";
for ($i = 1; $i <= 5; $i++) {
    $docSlug = 'documentary-' . $i . '-' . rand(1000, 9999);
    Documentary::create([
        'title' => ['en' => "Documentary $i: Nature & Science", 'ar' => "Ÿàÿ´ÿßÿ¶ŸÇŸä $i: ÿßŸÑÿ∑ÿ®Ÿäÿπÿ© ŸàÿßŸÑÿπŸÑŸàŸÖ"],
        'slug' => $docSlug,
        'description' => ['en' => "Educational documentary about nature and science", 'ar' => "Ÿàÿ´ÿßÿ¶ŸÇŸä ÿ™ÿπŸÑŸäŸÖŸä ÿπŸÜ ÿßŸÑÿ∑ÿ®Ÿäÿπÿ© ŸàÿßŸÑÿπŸÑŸàŸÖ"],
        'duration' => rand(45, 90),
        'video_url' => 'https://sample-videos.com/video123/mp4/720/big_buck_bunny_720p_1mb.mp4',
        'thumbnail' => 'https://via.placeholder.com/300x169/2ecc71/ffffff?text=Doc+' . $i,
        'release_year' => 2024,
        'director' => "Director $i",
        'is_featured' => rand(0, 1),
        'is_published' => true,
        'views_count' => rand(500, 10000),
        'category_id' => $categories->random()->id,
        'language_id' => rand(0, 1) ? $arabicLang->id : $englishLang->id,
    ]);
    echo "  ‚úì Created documentary $i\n";
}

// ========== CARTOONS ==========
echo "\nüé® Creating Cartoons...\n";
for ($i = 1; $i <= 5; $i++) {
    $cartoonSlug = 'cartoon-adventure-' . $i . '-' . rand(1000, 9999);
    Cartoon::create([
        'title' => ['en' => "Cartoon Adventure $i", 'ar' => "ŸÖÿ∫ÿßŸÖÿ±ÿ© ŸÉÿ±ÿ™ŸàŸÜŸäÿ© $i"],
        'slug' => $cartoonSlug,
        'description' => ['en' => "Fun cartoon for kids and family", 'ar' => "ŸÉÿ±ÿ™ŸàŸÜ ŸÖŸÖÿ™ÿπ ŸÑŸÑÿ£ÿ∑ŸÅÿßŸÑ ŸàÿßŸÑÿπÿßÿ¶ŸÑÿ©"],
        'duration' => rand(20, 45),
        'video_url' => 'https://sample-videos.com/video123/mp4/720/big_buck_bunny_720p_1mb.mp4',
        'thumbnail' => 'https://via.placeholder.com/300x169/f39c12/ffffff?text=Cartoon+' . $i,
        'age_rating' => 'G',
        'is_featured' => rand(0, 1),
        'is_published' => true,
        'views_count' => rand(2000, 15000),
        'category_id' => $categories->random()->id,
        'language_id' => $arabicLang->id,
    ]);
    echo "  ‚úì Created cartoon $i\n";
}

// ========== LIVE STREAMS ==========
echo "\nüì° Creating Live Streams...\n";
for ($i = 1; $i <= 3; $i++) {
    $liveSlug = 'live-channel-' . $i . '-' . rand(1000, 9999);
    LiveStream::create([
        'title' => ['en' => "Live Channel $i", 'ar' => "ŸÇŸÜÿßÿ© ŸÖÿ®ÿßÿ¥ÿ±ÿ© $i"],
        'slug' => $liveSlug,
        'description' => ['en' => "24/7 live streaming channel", 'ar' => "ŸÇŸÜÿßÿ© ÿ®ÿ´ ŸÖÿ®ÿßÿ¥ÿ± ÿπŸÑŸâ ŸÖÿØÿßÿ± ÿßŸÑÿ≥ÿßÿπÿ©"],
        'stream_url' => 'https://cph-p2p-msl.akamaized.net/hls/live/2000341/test/master.m3u8',
        'thumbnail' => 'https://via.placeholder.com/300x169/e74c3c/ffffff?text=Live+' . $i,
        'is_live' => true,
        'is_featured' => rand(0, 1),
        'is_published' => true,
        'viewers_count' => rand(100, 5000),
        'category_id' => $categories->random()->id,
        'language_id' => $arabicLang->id,
    ]);
    echo "  ‚úì Created live stream $i\n";
}

echo "\n‚úÖ Content seeding completed successfully!\n";
echo "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n";
echo "üìä Summary:\n";
echo "  ‚Ä¢ Movies: " . Movie::count() . "\n";
echo "  ‚Ä¢ Series: " . Series::count() . "\n";
echo "  ‚Ä¢ Episodes: " . Episode::count() . "\n";
echo "  ‚Ä¢ Podcasts: " . Podcast::count() . "\n";
echo "  ‚Ä¢ Sports: " . Sport::count() . "\n";
echo "  ‚Ä¢ Documentaries: " . Documentary::count() . "\n";
echo "  ‚Ä¢ Cartoons: " . Cartoon::count() . "\n";
echo "  ‚Ä¢ Live Streams: " . LiveStream::count() . "\n";
echo "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n";
